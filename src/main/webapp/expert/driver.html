<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>DREAMTREE</title>
<script>
var nodePart; // 각 노드를 찾기 위한 오브젝트 저장용 전역 변수

// 마인드 맵 설정용 스크립트
  function init() {
    var $ = go.GraphObject.make;
    myDiagram =
      $(go.Diagram, "myDiagramDiv",
        {
    //마인맵 영역 설정
          "commandHandler.copiesTree": true, //복사 가능한 트리 구조
          "commandHandler.deletesTree": true, //삭제 가능한 트리 구조
          "draggingTool.dragsTree": true, // 드래그 가능한 트리 구조
          initialContentAlignment: go.Spot.Center,  // 최초 로드시 마인드 맵 중앙 위치
          "undoManager.isEnabled": false // undo/redo 기능 
        });
    
    // 수정이 되었을경우 브라우저 title 뒤쪽게  '*'을 추가
    myDiagram.addDiagramListener("Modified", function(e) {
      var button = document.getElementById("SaveButton");
//       if (button) button.disabled = !myDiagram.isModified;
      var idx = document.title.indexOf("*");
      if (myDiagram.isModified) {
        if (idx < 0) document.title += "*";
      } else {
        if (idx >= 0) document.title = document.title.substr(0, idx);
      }
    });
    
    // 각 요소를 규정하는 스크립트 (텍스트와 사각형 /아이콘 으로 구정되어있음)
    
    myDiagram.nodeTemplate =
      $(go.Node, "Vertical", // 세로구조
        { selectionObjectName: "TEXT" },
        
      //텍스트와  사각형을 묶어서 하나로 보여줌
      $(go.Panel, "Auto",   
       //사각형 부분   //코드상 아래 있을수록 Z-inex상 위에 표시 되므로 사각형 부터
       $(go.Shape, "RoundedRectangle", //라운드 사각형모양
            {
            name:"brush",
            stroke:"black", // 기본 선색
            fill:"black", //기본 내부 색
            stretch: go.GraphObject.Horizontal,
            strokeWidth: 1,
              
            //라인 포트를 규정함 (현재는 좌우 포트로 선이 연결됨)
            portId: "", fromSpot: go.Spot.LeftRightSides, toSpot: go.Spot.LeftRightSides
            },
                   
            new go.Binding("stroke", "brush").makeTwoWay(), // 선색을 저장함
            new go.Binding("fill", "color").makeTwoWay(), // 내부색을 저장함
            
            //선의 출발지와 도착지에 대한 규정
            new go.Binding("fromSpot", "dir", function(d) { return spotConverter(d, true); }),
            new go.Binding("toSpot", "dir", function(d) { return spotConverter(d, false); })),
            
          //텍스트 부분
            $(go.TextBlock,
              { margin:2,
                name: "TEXT",
                stroke:"white", 
                minSize: new go.Size(30, 15),
                maxSize: new go.Size(200, NaN),
                editable: true
              },
              
              //글자의 크기와 글꼴을 기억하게 함
              new go.Binding("text", "text").makeTwoWay(),
              new go.Binding("scale", "scale").makeTwoWay(),
              new go.Binding("font", "font").makeTwoWay())
           
            
         ),
        //아이콘에 대한 부분 //아이콘을 아래에 따로 표시 하기 위해 패널을 따로 묶고 가로로 배치 하기 위해 테이블을 사용
        $(go.Panel, "Table", //테이블 구조        
          $(go.Picture, "/img/pic.png",
                  {name:"pic",
                row: 0, column: 0, margin: 2, //테이블 상 위치 지정
                maxSize: new go.Size(20, 17), //사이즈
                  visible: false , //기본적으로 표시하지 않음
                  click: function(e, obj) { imgpopup(obj.part.data.key); }}, //클릭 이벤트
                  
                new go.Binding("visible", "pic", function(i) { return i ? true : false; }).makeTwoWay()), //아이콘을 표시설정 상항연산 이용 상태가 전환되도록 구성 
          
            
            $(go.Picture, "/img/mov.png",
                  {name:"video",
                row: 0, column: 1, margin: 2,
                maxSize: new go.Size(20, 17),
                  visible: false,
                  click: function(e, obj) { videopopup(obj.part.data.key); }},
            
                  new go.Binding("visible", "video", function(i) { return i ? true : false; }).makeTwoWay()),
          
            
            $(go.Picture, "/img/url.png",
                  {name:"link",
                row: 0, column: 2, margin: 2,
                maxSize: new go.Size(20, 17),
                  visible: false,
                  click: function(e, obj) { linkpopup(obj.part.data.key); } },                    
            
                  new go.Binding("visible", "link", function(i) { return i ? true : false; }).makeTwoWay())            
            ),
            //위치 정보를 기억함 (중앙 기준)
            new go.Binding("location", "loc", go.Point.parse).makeTwoWay(go.Point.stringify),        
            new go.Binding("locationSpot", "dir", function(d) { return spotConverter(d, false); })
      );
    
    

    
    
    // 각 요소에 선택시 표시되는 부분을 규정하는 스크립트
    
    myDiagram.nodeTemplate.selectionAdornmentTemplate =
      $(go.Adornment, "Spot",
        $(go.Panel, "Auto",
          // 선택시 dodgerblue색 사각형이 형성됨 
          $(go.Shape, { fill: null, stroke: "dodgerblue", strokeWidth: 3 }),
          $(go.Placeholder)
        ),
        
        //선택시 표시되는 버튼 규정
        $(go.Panel, "Horizontal", // 가로 구조
          { alignment: go.Spot.Top, alignmentFocus: go.Spot.Bottom }, //상단에 표시 함
          //요소 추가 버튼
          $("Button",
            { click: addNodeAndLink }, //클릭 이벤트  
            $(go.TextBlock, "+", //글자 표시 부분
              { font: "nomal 12pt", desiredSize: new go.Size(12, 12), textAlign: "center" })
          ),
          //색 변경 버튼
          $("Button",
            { click: changeColor, "_buttonFillOver": "transparent" },  //클릭 이벤트 / 마우스 오버시 투명화
            new go.Binding("ButtonBorder.fill", "brush", nextColor), // 다음으로 변경될 색을 표시
            $(go.Shape,
              { fill: null, stroke: null, desiredSize: new go.Size(11, 11) })
          )
        )
        
      );
      
      
    //색 변경시 사용될 색 배열
    var myColors = ["lightgray", "lightblue", "lightgreen", "yellow", "orange", "pink" , "black"];

    //현재 색을 이용 다음 색을 리턴하는 함수
    function nextColor(c) {
      var idx = myColors.indexOf(c);
      if (idx < 0) return "lightgray";
      if (idx >= myColors.length-1) idx = 0;
      return myColors[idx+1];
    }

    //색을 변경해 주는 함수
    function changeColor(e, button) {
      
      var node = button.part.adornedPart;
      var brush = node.findObject("brush"); // 색이 변경 되야 하는 선부분을 찾는다      
      if (brush === null) return;
      
      //undo / redo 에 사용 되는 스크립트 시작부분 (버그로 인해 주석 처리 함)
//       node.diagram.startTransaction("Change brush"); 
      
      brush.stroke = nextColor(brush.stroke);//선색 변경
      brush.fill = brush.stroke;// 내부 색을 변경  
      
      button["_buttonFill"] = nextColor(brush.stroke);  //버튼의 색도 같이 변경해줌
      
    //undo / redo 에 사용 되는 스크립트 끝부분 (버그로 인해 주석 처리 함) - 사용시  시작과 끝 사이에 있는 부분이 undo/redo 로 삭제/복원 됨
//       node.diagram.commitTransaction("Change brush");
      
   // 연결되는 링크의 색을 같이 변경 해 주기 위해 저장하고 불러옴 
      save(); 
      load();
    }
      
      
      
    
    //각 요소에 종속되는 contextMenu 정의
    myDiagram.nodeTemplate.contextMenu =
      $(go.Adornment, "Vertical", // 세로 구조
        $("ContextMenuButton",
          $(go.TextBlock, "글자키우기"),
          { click: function(e, obj) { changeTextSize(obj, 1.1); } }),
        $("ContextMenuButton",
          $(go.TextBlock, "글자 줄이기"),
          { click: function(e, obj) { changeTextSize(obj, 1/1.1); } }),
        $("ContextMenuButton",
          $(go.TextBlock, "굵게/일반"),
          { click: function(e, obj) { toggleTextWeight(obj); } }),        
        $("ContextMenuButton",
          $(go.TextBlock, "아이템 추가/삭제"),
          { click: function(e, obj) {           
            nodePart = obj.part.adornedPart;  // 각 요소를 찾기 위해 필요한 노드 부분을 전역 변수로 저장한다
            var key = obj.part.data.key;  // DB에서 데이터를 받아 오기 위한 각 요소의 키를 받아 온다
            popup(key);  // 팝업을 열어 줌
          } }),
        $("ContextMenuButton",
          $(go.TextBlock, "자동정렬"),
          {
            click: function(e, obj) {
                var adorn = obj.part;
//                 adorn.diagram.startTransaction("Subtree Layout");
                layoutTree(adorn.adornedPart);
//                 adorn.diagram.commitTransaction("Subtree Layout");
              }
          }
        )
      );
    
    
 
    
    
    
    
    
    // 선과 선을 연결 하는 링크 규정 스크립트
    myDiagram.linkTemplate =
      $(go.Link,
        {
        curve: go.Link.Bezier,
          fromShortLength: -2,
          toShortLength: -2,
          selectable: false
        },
        $(go.Shape, // 기본적으로 선의 색을 따라 간다 선의 색이 규정되지 않으면 기본 검정
          { name:"link",strokeWidth: 3},
          new go.Binding("stroke", "toNode", function(n) {
            if (n.data.brush) return n.data.brush;
            return "black";
          }).ofObject())
      );
    
    
    
    
    
    // 디스플레이 영역 전체에 작동 하는 contextMenu 
    myDiagram.contextMenu =
      $(go.Adornment, "Vertical", // 세로 구조
          //undo/redo 기능을 제한 하기 위해 주석 처리 함
//         $("ContextMenuButton",
//           $(go.TextBlock, "Undo"),
//           { click: function(e, obj) { e.diagram.commandHandler.undo(); } },
//           new go.Binding("visible", "", function(o) { return o.diagram && o.diagram.commandHandler.canUndo(); }).ofObject()),
//         $("ContextMenuButton",
//           $(go.TextBlock, "Redo"),
//           { click: function(e, obj) { e.diagram.commandHandler.redo(); } },
//           new go.Binding("visible", "", function(o) { return o.diagram && o.diagram.commandHandler.canRedo(); }).ofObject()),
//         $("ContextMenuButton",
//           $(go.TextBlock, "Save"),
//           { click: function(e, obj) { save(); } }),
//         $("ContextMenuButton",
//           $(go.TextBlock, "Load"),
//           { click: function(e, obj) { load(); } }),
        $("ContextMenuButton",
          $(go.TextBlock, "자동정렬"),
        { click: function(e, obj) { layoutAll(); } })
      );
    
    
    //선택된 요소의 이동을 규정한 스크립트 / 좌우로 이동 했을 경우 시작되는 root 부분을 규정 한다
    myDiagram.addDiagramListener("SelectionMoved", function(e) {
      var rootX = myDiagram.findNodeForKey(0).location.x;
      myDiagram.selection.each(function(node) {
          if (node.data.parent !== 0) return;  
          var nodeX = node.location.x;
          if (rootX < nodeX && node.data.dir !== "right") {
            updateNodeDirection(node, "right");
          } else if (rootX > nodeX && node.data.dir !== "left") {
            updateNodeDirection(node, "left");
          }
          layoutTree(node);
        });
    });
    // 페이지에 저장된 json 형식의 데이터를 불러와 디스플레이 영역에 표시 한다
    load();
  }
  
  
  
  //선의 출발지와 도착지를 리턴하는 함수
  function spotConverter(dir, from) {
    if (dir === "left") {
      return (from ? go.Spot.Left : go.Spot.Right);
    } else {
      return (from ? go.Spot.Right : go.Spot.Left);
    }
  }
  
  
  //텍스트의 사이즈를 변경 해 주는 함수 (배율은 1.1)
  function changeTextSize(obj, factor) {
  var adorn = obj.part;
//     adorn.diagram.startTransaction("Change Text Size");
    var node = adorn.adornedPart;
    console.log(node);
    var tb = node.findObject("TEXT");
    tb.scale *= factor;
//     adorn.diagram.commitTransaction("Change Text Size");
  }
  
  
  //텍스트의 볼드/노멀을 변경하는 스크립트
  function toggleTextWeight(obj) {
    var adorn = obj.part;
//     adorn.diagram.startTransaction("Change Text Weight");
    var node = adorn.adornedPart;
    var tb = node.findObject("TEXT");
    // 해당 라이브러리는 볼드여부가 텍스트의 맨 앞부분에 규정되어있다.
    var idx = tb.font.indexOf("bold");
    if (idx < 0) {
      tb.font = "bold " + tb.font;
    } else {
      tb.font = tb.font.substr(idx + 5);
    }
//     adorn.diagram.commitTransaction("Change Text Weight");
  }
  
  
  //각 자식 요소의 방향을 갱신 하는 함수
  function updateNodeDirection(node, dir) {
    myDiagram.model.setDataProperty(node.data, "dir", dir);
    // 자식 요소의 방향을 재귀적으로 갱신한다
    var chl = node.findTreeChildrenNodes(); //자식 요소의 반복자
    while(chl.next()) {
      updateNodeDirection(chl.value, dir);
    }
  }
  
  
  
  
  //요소를 추가 해 주는 함수
  function addNodeAndLink(e, obj) {
    var adorn = obj.part;
    var diagram = adorn.diagram;
//     diagram.startTransaction("Add Node");
    var oldnode = adorn.adornedPart;
    var olddata = oldnode.data;
    var oldBrush = olddata.brush; 
    // 방향과 선의 색을 상속 받는다
    var newdata = { text: "입력해주세요", brush: oldBrush,color:oldBrush, dir: olddata.dir, parent: olddata.key, pic:false , video:false, link:false};
    diagram.model.addNodeData(newdata);
    layoutTree(oldnode);
//     diagram.commitTransaction("Add Node");
  }
  
  
  //트리 구조에서 해당 요소를 어디에 추가 할지를 선택하는  함수
  function layoutTree(node) {
    if (node.data.key === 0) { //root에서 시작인지  
      layoutAll();  
    } else { // 아니면 부모에서 시작인지
      var parts = node.findTreeParts();
      layoutAngle(parts, node.data.dir === "left" ? 180 : 0);
    }
  }
  
  
  
  function layoutAngle(parts, angle) {
    var layout = go.GraphObject.make(go.TreeLayout,
        { angle: angle,
          arrangement: go.TreeLayout.ArrangementFixedRoots,
          nodeSpacing: 5,
          layerSpacing: 20,
          setsPortSpot: false, // 따로 함수을 분기함 기본이true이므로 false로 규정함 수정 불가!
          setsChildPortSpot: false });
    layout.doLayout(parts);
  }
  
  
  //자동 정렬용 함수
  function layoutAll() {
    var root = myDiagram.findNodeForKey(0);
    if (root === null) return;
//     myDiagram.startTransaction("Layout");
    
    var rightward = new go.Set(go.Part);
    var leftward = new go.Set(go.Part);
    root.findLinksConnected().each(function(link) {
        var child = link.toNode;
        if (child.data.dir === "left") {
          leftward.add(root);  
          leftward.add(link);
          leftward.addAll(child.findTreeParts());
        } else {
          rightward.add(root);
          rightward.add(link);
          rightward.addAll(child.findTreeParts());
        }
      });
        layoutAngle(rightward, 0);
    layoutAngle(leftward, 180);
//     myDiagram.commitTransaction("Layout");
  }
  
  
  
  // 다이어그램 전체 데이터를 json형식으로 페이지에만 저장하는 함수
  function save() {
  document.getElementById("mySavedModel").value = myDiagram.model.toJson();
//     myDiagram.isModified = false;
  }
  
  //다이어그램 전체 데이터를 json형식으로 서버에 저장하는 함수
  function serversave() {
    document.getElementById("mySavedModel").value = myDiagram.model.toJson();
      myDiagram.isModified = false;
      capture();//화면 캡쳐와 서버 저장용 함수
  }
  
  //전체 데이터 수정 함수
  function servermodify() {
    if(check()){
    document.getElementById("mySavedModel").value = myDiagram.model.toJson();
      myDiagram.isModified = false;
      modify(); //새로운 화면 캡쳐 및 수정용 함수
    }
  }  
  
  //json를 화면에 그려주는 함수
  function load() {
    myDiagram.model = go.Model.fromJson(document.getElementById("mySavedModel").value);
  }
</script>
<script>
function view_init() {
    var $ = go.GraphObject.make;
    myDiagram =
      $(go.Diagram, "viewDiagramDiv",
        {
    //마인맵 영역 설정
          "commandHandler.copiesTree": true, //복사 가능한 트리 구조
          "commandHandler.deletesTree": true, //삭제 가능한 트리 구조
          "draggingTool.dragsTree": true, // 드래그 가능한 트리 구조
          initialContentAlignment: go.Spot.Center,  // 최초 로드시 마인드 맵 중앙 위치
          "undoManager.isEnabled": false // undo/redo 기능 
        });
    
    
    
    
    // 수정이 되었을경우 브라우저 title 뒤쪽게  '*'을 추가
    myDiagram.addDiagramListener("Modified", function(e) {
      var button = document.getElementById("SaveButton");
      if (button) button.disabled = !myDiagram.isModified;
      var idx = document.title.indexOf("*");
      if (myDiagram.isModified) {
        if (idx < 0) document.title += "*";
      } else {
        if (idx >= 0) document.title = document.title.substr(0, idx);
      }
    });
    
    
    
    
    // 각 요소를 규정하는 스크립트 (텍스트와 라인 /아이콘 으로 구정되어있음)
    
    myDiagram.nodeTemplate =
      $(go.Node, "Vertical", // 세로 구조
        { selectionObjectName: "TEXT" },
        
        //텍스트 부분
       
     $(go.Panel, "Auto",     
     //라인 부분     
     $(go.Shape, "RoundedRectangle",
          {
          name:"brush",
          stroke:"black",
          fill:"black",
          stretch: go.GraphObject.Horizontal,
            strokeWidth: 1,
            
            //라인 포트를 규정함 (현재는 좌우 포트로 선이 연결됨)
            portId: "", fromSpot: go.Spot.LeftRightSides, toSpot: go.Spot.LeftRightSides
          },
                 
          new go.Binding("stroke", "brush").makeTwoWay(), // 선색을 저장함
          new go.Binding("fill", "color").makeTwoWay(), // 내부색을 저장함
          
          //선의 출발지와 도착지에 대한 규정
          new go.Binding("fromSpot", "dir", function(d) { return spotConverter(d, true); }),
          new go.Binding("toSpot", "dir", function(d) { return spotConverter(d, false); })),
          
          $(go.TextBlock,
                  {margin:2,
                    name: "TEXT",
                    stroke:"white",
                    minSize: new go.Size(30, 15),
                    maxSize: new go.Size(200, NaN),
                    editable: false
                  },
                  
                  //글자의 크기와 글꼴을 기억하게 함
                  new go.Binding("text", "text").makeTwoWay(),
                  new go.Binding("scale", "scale").makeTwoWay(),
                  new go.Binding("font", "font").makeTwoWay())
          
          
          ),
        //아이콘에 대한 부분
          $(go.Panel, "Table", //테이블 구조
            
            $(go.Picture, "/img/pic.png",
                    {name:"pic",
                  row: 0, column: 0, margin: 2, //테이블 상 위치 지정
                  maxSize: new go.Size(20, 17), //사이즈
                    visible: false , //기본적으로 표시하지 않음
                    click: function(e, obj) { imgpopup(obj.part.data.key); }}, //클릭 이벤트
                    
                  new go.Binding("visible", "pic", function(i) { return i ? true : false; }).makeTwoWay()), //아이콘을 표시할지를 저장함
            
              
              $(go.Picture, "/img/mov.png",
                    {name:"video",
                  row: 0, column: 1, margin: 2,
                  maxSize: new go.Size(20, 17),
                    visible: false,
                    click: function(e, obj) { videopopup(obj.part.data.key); }},
              
                    new go.Binding("visible", "video", function(i) { return i ? true : false; }).makeTwoWay()),
            
              
              $(go.Picture, "/img/url.png",
                    {name:"link",
                  row: 0, column: 2, margin: 2,
                  maxSize: new go.Size(20, 17),
                    visible: false,
                    click: function(e, obj) { linkpopup(obj.part.data.key); } },                    
              
                    new go.Binding("visible", "link", function(i) { return i ? true : false; }).makeTwoWay())            
              ),
       
        //위치 정보를 기억함 (중앙 기준)
        new go.Binding("location", "loc", go.Point.parse).makeTwoWay(go.Point.stringify),        
        new go.Binding("locationSpot", "dir", function(d) { return spotConverter(d, false); })
        
      );
    
    

    
    
    // 각 요소에 선택시 표시되는 부분을 규정하는 스크립트
    
    myDiagram.nodeTemplate.selectionAdornmentTemplate =
      $(go.Adornment, "Spot",
        $(go.Panel, "Auto",
          // 선택시 dodgerblue색 사각형이 형성됨 
          $(go.Shape, { fill: null, stroke: "dodgerblue", strokeWidth: 3 }),
          $(go.Placeholder)
        ) 
      );
      
      
  
    
    
    // 선과 선을 연결 하는 링크 규정 스크립트
    myDiagram.linkTemplate =
      $(go.Link,
        {
        curve: go.Link.Bezier,
          fromShortLength: -2,
          toShortLength: -2,
          selectable: false
        },
        $(go.Shape, // 기본적으로 선의 색을 따라 간다 선의 색이 규정되지 않으면 기본 검정
          { name:"link",strokeWidth: 3},
          new go.Binding("stroke", "toNode", function(n) {
            if (n.data.brush) return n.data.brush;
            return "black";
          }).ofObject())
      );
    
    
    
    
    //선택된 요소의 이동을 규정한 스크립트 / 좌우로 이동 했을 경우 시작되는 root 부분을 규정 한다
    myDiagram.addDiagramListener("SelectionMoved", function(e) {
      var rootX = myDiagram.findNodeForKey(0).location.x;
      myDiagram.selection.each(function(node) {
          if (node.data.parent !== 0) return;  
          var nodeX = node.location.x;
          if (rootX < nodeX && node.data.dir !== "right") {
            updateNodeDirection(node, "right");
          } else if (rootX > nodeX && node.data.dir !== "left") {
            updateNodeDirection(node, "left");
          }
          layoutTree(node);
        });
    });
    // 페이지에 저장된 json 형식의 데이터를 불러와 디스플레이 영역에 표시 한다 - 추후 DB 연결로 변경 예정
    view_load();
  }
  
  
  
  //선의 출발지와 도착지를 리턴하는 함수
  function spotConverter(dir, from) {
    if (dir === "left") {
      return (from ? go.Spot.Left : go.Spot.Right);
    } else {
      return (from ? go.Spot.Right : go.Spot.Left);
    }
  }
  
  
  //각 자식 요소의 방향을 갱신 하는 함수
  function updateNodeDirection(node, dir) {
    myDiagram.model.setDataProperty(node.data, "dir", dir);
    // 자식 요소의 방향을 재귀적으로 갱신한다
    var chl = node.findTreeChildrenNodes(); //자식 요소의 반복자
    while(chl.next()) {
      updateNodeDirection(chl.value, dir);
    }
  }
  
 
  
  //트리 구조에서 해당 요소를 어디에 추가 할지를 선택하는  함수
  function layoutTree(node) {
    if (node.data.key === 0) { //root에서 시작인지  
      layoutAll();  
    } else { // 아니면 부모에서 시작인지
      var parts = node.findTreeParts();
      layoutAngle(parts, node.data.dir === "left" ? 180 : 0);
    }
  }
  
  
  
  function layoutAngle(parts, angle) {
    var layout = go.GraphObject.make(go.TreeLayout,
        { angle: angle,
          arrangement: go.TreeLayout.ArrangementFixedRoots,
          nodeSpacing: 5,
          layerSpacing: 20,
          setsPortSpot: false, // 따로 함수을 분기함 기본이true이므로 false로 규정함 수정 불가!
          setsChildPortSpot: false });
    layout.doLayout(parts);
  }
  
  
  
  function layoutAll() {
    var root = myDiagram.findNodeForKey(0);
    if (root === null) return;
//     myDiagram.startTransaction("Layout");
    
    var rightward = new go.Set(go.Part);
    var leftward = new go.Set(go.Part);
    root.findLinksConnected().each(function(link) {
        var child = link.toNode;
        if (child.data.dir === "left") {
          leftward.add(root);  
          leftward.add(link);
          leftward.addAll(child.findTreeParts());
        } else {
          rightward.add(root);
          rightward.add(link);
          rightward.addAll(child.findTreeParts());
        }
      });
        layoutAngle(rightward, 0);
    layoutAngle(leftward, 180);
//     myDiagram.commitTransaction("Layout");
  }
  function view_load() {
    myDiagram.model = go.Model.fromJson(document.getElementById("viewSavedModel").value);
  }
</script>
</head>
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
<link rel="stylesheet" type="text/css" href="../common/css/header.css">
<link rel="stylesheet" type="text/css" href="css/expert.css">
<link rel="stylesheet" type="text/css" href="css/chat.css">
<link rel="stylesheet" type="text/css" href="../mystuff/css/modal.css">
<link rel="stylesheet" type="text/css" href="../common/css/common.css">
<link rel="stylesheet" type="text/css" href="../auth/css/login.css">
<style>

.fa-plus {
    top: 49%;
    left: 50%;
    margin-left: -25px;
    position: absolute;
    color: rgba(158, 158, 158, 0.47);
    text-shadow: 1px 1px rgba(96, 125, 139, 0.58);
}
.dashboard {
    position: relative;
}
.detail-plan-area,
.detail-mentee-area {
    display: inline-block;
    height: 100%;
}
.detail-plan-area {
    width: 65%;
}
.detail-mentee-area {
    width: 33.4%;
    height: 98%;
    position: absolute;
    padding: 10px;
    top: 0px;
    right: 0px;
}
.across-close, .chat-close {
    top: 12px;
    right: 10px;
    position: absolute;
    color: rgba(158, 158, 158, 0.4);
    cursor: pointer;
    z-index: 200;
}
.across-close:hover,
, .chat-close:hover {
    color: rgba(96, 125, 139, 0.4);
}
.across-count {
    display: inline-block;
    margin: 0 10px;
    padding: 10px 10px;
    padding-top: 5px;
    border-radius: 10px;
    font-size: 22px;
    font-weight: bold;
    color: rgba(0, 0, 0, 0.6);
    background: #FFC107;
    cursor: default;
}
.across-comment {
    top: 35%;
    left: 50%;
    position: absolute;
    margin: -40px 0 0 -40px;
    font-size: 5em;
    color: rgba(96, 125, 139, 0.8);
}
.across-comment~h3 {
    top: 43%;
    left: 53%;
    margin: -10px 0 0 -150px;
    position: absolute;
    color: rgba(128, 128, 128, 0.8);
    cursor: default;
}
.mentee-info-area {
    position: absolute;
    top: 100px;
    height: 640px;
}
.mentee-info {
    position: relative;
    width: 140px;
    display: inline-block;
    text-align: center;
    margin: 10px 0;
    cursor: pointer;
}
.mentee-info img {
    width: 110px;
    border-radius: 100px;
    box-shadow: 1px 1px 3px #9E9E9E;
    height: 110px;
}
.mentee-info-name {
    font-size: 19px;
    font-weight: bold;
}
.fat {
    color: rgba(255, 255, 255, 0.7);
    margin-top: 10px;
    margin-right: 15px;
    display: inline-block;
    font: normal normal normal 24px FontAwesome;
    text-rendering: auto;
    -webkit-font-smoothing: antialiased;
}
.plan-name {
    display: inline-block;
    background: tomato;
    width: 1100px;
    height: 40px;
    border-radius: 30px;
    color: white;
    font-size: 1.3em;
    font-weight: 600;
    padding: 0px 0 0 30px;
    line-height: 35px;
    position: relative;
    top: 2px;
}
.plan-name > input {
    border-radius: 30px;
    border: none;
    background: white;
    position: relative;
    left: 30px;
    padding-left: 20px;
    padding-right: 20px;
    width: 80%;
    height: 65%;
    font-size: 20px;
    font-weight: 600;
}
.plan-item {
    display: inline-block;
    position: absolute;
    right: 0;
    cursor: pointer;
}
.editor-div {
    display: none;
    width: 100%;
    height: 100%;
}
.save-fa {
    display: inline-block;
    font: normal normal normal 14px/1 FontAwesome;
    font-size: 1.3em;
    text-rendering: auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    
    position: relative;
    top: -8px;
    padding: 10px 20px;
    border-radius: 30px;
    background: #8BC34A;
    color: #FFF;
}
.save-fa:HOVER {
    background: rgba(139, 195, 74, .5);
}
.close-fa {
    display: inline-block;
    font: normal normal normal 14px/1 FontAwesome;
    font-size: 2.8em;
    color: rgba(158, 158, 158, .5);
    text-rendering: auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}
.close-fa:HOVER {
    color: rgba(158, 158, 158, .2);
}
/* #myDigramDiv { */
/*     width: 100%; */
/*     height: 90%; */
/*     margin: 20px 0px; */
/*     position: relative; */
/*     -webkit-tap-highlight-color: rgba(255, 255, 255, 0); */
/*     cursor: auto; */
/* } */
/* #myDigramDiv > canvas {
    position: absolute;
    top: 0px;
    left: 0px;
    z-index: 2;
    user-select: none;
    width: 1275px;
    height: 650px;
    cursor: auto;
} */

</style>
<body>
<div id="header"></div>
<div class="container">
  <div class="contents">
    <div class="frame-area frame-area-center board">
      <div class="board-call dashboard">
         <span class="board-fa fa fa-tree" aria-hidden="true"></span>
         <div class="board-explain">멘토께서는 Editor를 이용해 진로에 대한 설계도를 만드실 수 있습니다.<br>만드신 설계도는 학생들이 진로를 탐색하는데 큰 도움이 됩니다.</div>
      </div>
    </div>
    <div class="frame-area frame-area-left   editor">
      <div class="editor-call dashboard">
        <div class="editor-explain faT fa-pencil-square-o" aria-hidden="true"> 새로운 진로 플랜을 설계해보세요.</div>
      <!-- 다이어그램 영역 시작 -->
        <div class="editor-div animated fadeIn">
          <div class="plan-name"> 설계도 제목 <input type='text' value=''></div>
          <div class="plan-item">
            <span class="editor-save save-fa fa-floppy-o" aria-hidden="true"> 저장 </span>
            <span class="editor-close close-fa fa-times-circle" aria-hidden="true"></span>
          </div>
          <div id="myDiagramDiv" style="margin: 20px 0px; width: 100%; height: 90%"></div>
        </div>
      <!-- 다이어그램 영역 끝  -->
      <!--  페이지에 데이터를 저장하는 텍스트에어리어 시작 -->
      <!--  수정인지 저장인지 판단 기존 데이터 표시 또는 기본 데이터 표시 분기 -->
      <!--  <textarea id="mySavedModel" style="width:100%;height:400px;display: none;"> -->
      <!--    ${minddata.data} -->
      <!--  </textarea> -->
        <textarea id="mySavedModel" style="width:100%;height:400px;display: none;">
          { "class": "go.TreeModel",
            "nodeDataArray": [ {"key":0, "text":"직  업", "loc":"0 0" ,"brush":"black" , "pic":"" , "video":""} ]}
        </textarea>
      </div>
    </div>
    <div class="frame-area frame-area-right  across">
      <div class="across-call dashboard">
        <div class="across-explain">Board에서 확인할 플랜을 선택하세요.</div>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="warn-modal-wrapper">
  <div class="warn-modal">
    <div class="warn-modal-head">
      <i class="warn-modal-btn-close warn-modal-trigger fa fa-times" aria-hidden="true"></i>
    </div>
    <div class="warn-modal-content">
        <div class="warn-modal-good-job">
          <i class="fa-px fa-info-circle" aria-hidden="true"></i>
        </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="../common/js/context.js"></script>
<script type="text/javascript" src="../node_modules/jquery/dist/jquery.js"></script>
<script type="text/javascript" src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script type="text/javascript" src="../node_modules/blueimp-load-image/js/load-image.js"></script>
<script type="text/javascript" src="../node_modules/blueimp-load-image/js/load-image-meta.js"></script>
<script type="text/javascript" src="../node_modules/blueimp-load-image/js/load-image-exif.js"></script>
<script type="text/javascript" src="../node_modules/blueimp-load-image/js/load-image-exif-map.js"></script>
<script type="text/javascript" src="../node_modules/blueimp-load-image/js/load-image-orientation.js"></script>
<script type="text/javascript" src="../node_modules/blueimp-canvas-to-blob/js/canvas-to-blob.js"></script>
<script type="text/javascript" src="../node_modules/blueimp-file-upload/js/jquery.iframe-transport.js"></script>
<script type="text/javascript" src="../node_modules/blueimp-file-upload/js/jquery.fileupload.js"></script>
<script type="text/javascript" src="../node_modules/blueimp-file-upload/js/jquery.fileupload-process.js"></script> 
<script type="text/javascript" src="../node_modules/blueimp-file-upload/js/jquery.fileupload-image.js"></script>
<script type="text/javascript" src="../node_modules/handlebars/dist/handlebars.js"></script>
<script type="text/javascript" src="../auth/js/login.js"></script>
<script type="text/javascript" src="../common/js/common.js"></script>
<script type="text/javascript" src="../mystuff/js/modal.js"></script>
<script type="text/javascript" src="js/go.js"></script>
<script type="text/javascript" src="js/html2canvas.js"></script>
<script>
$(document.body).on('click', '.editor-save', function() {
	if (check()) warnModalStart('plan-save');
});
$(document.body).on('click', '.save-plan', function() {
	serversave();
	$('.warn-modal-comment > h3, .save-plan, .cancel-plan').remove();
	$('.warn-modal-comment').append("<h3 class='animated flash'><br>저장 중...</h3>");
});
$(document.body).on('click', '.close-plan', function() {
	warnModalEnd();
	$('.editor-div').addClass('animated fadeOut');
	setTimeout(function() {
		    $('.editor-div').remove();
			  $(".editor-explain, .fa-plus").removeClass("animated fadeOutUp");
			  $(".editor-explain, .fa-plus").addClass("animated fadeInDown");
			  setTimeout(function() {
			      $(".editor").switchClass("frame-area-center", "frame-area-left", 2000, "easeInOutBack");
			      $(".board").switchClass("frame-area-right", "frame-area-center", 2000, "easeInOutBack");
				    $('.editor').load('driver.html .editor-call');
				    $(".editor-explain, .fa-plus").removeClass("animated fadeInDown");
			  }, 400);
	}, 400);
});
$(document.body).on('click', '.cancel-plan, .enter-plan', function() {
	warnModalEnd();
});
//체킹 함수
function check(){
  if($(".plan-name input").val()==""){
	  warnModalStart('plan-name');
    return false;
  }else if(expertNo==undefined){
	  warnModalStart('plan-writer');
    return false;
  }else{
    return true;
  }
}
//화면 캡쳐 서버 저장용 함수
function capture() {
  html2canvas($("#myDiagramDiv"), { // 해당 영역만 스크린샷 생성
       onrendered: function(canvas) {
         $.post(serverRoot + "/editor/save.json", 
          {
          "title" : $(".plan-name input").val(),
          "writer" : expertNo,
          "data" : $("#mySavedModel").val(),
          "thumbnail" : canvas.toDataURL("image/png")
          }, function(ajaxResult) {
            if (ajaxResult.status == 'fail') {
            	warnModalStart('fail-plan');
            } else {
            	  warnModalEnd();
            	  $('.editor-div').addClass('animated fadeOut');
            	  setTimeout(function() {
            	        $('.editor-div').remove();
            	        $(".editor-explain, .fa-plus").removeClass("animated fadeOutUp");
            	        $(".editor-explain, .fa-plus").addClass("animated fadeInDown");
            	        setTimeout(function() {
            	            $(".editor").switchClass("frame-area-center", "frame-area-left", 2000, "easeInOutBack");
            	            $(".board").switchClass("frame-area-right", "frame-area-center", 2000, "easeInOutBack");
            	            $('.editor').load('driver.html .editor-call');
            	            $(".editor-explain, .fa-plus").removeClass("animated fadeInDown");
            	            boardList();
            	        }, 400);
            	  }, 400);
            }
          });
       }
   });
}
</script>
<script>
function boardList() {
    var count = 0;
    setTimeout(function() {
        $.getJSON(serverRoot + '/expert/board.json',
              {
                'pageNo': 1,
                'pageSize': 6, 
                'eno': memberInfo.memberNo
              }, function(ajaxResult) {
                var status = ajaxResult.status;
                if (status != "success") return; 
                
                var list = ajaxResult.data.list;
                console.log(list);
                
                var count = new Array();
                var mteNewMsg = 0;
                $.each(list, function(k, v) {
                    $.getJSON(serverRoot + '/message/menteeMessageCount.json', 
                    {
                      "cono": v.contentsNo,
                      "mswr": memberInfo.memberNo
                    }, function(ajaxResult) {
                        var status = ajaxResult.status;
                      if (ajaxResult.status == "fail") {
                          var board = $('.board-call');
                          var template = Handlebars.compile($('#boardTemp').html()); 
                          board.html(template({'list': list}));
                          return;
                      }
                        console.log(ajaxResult.data);
                        mteNewMsg = ajaxResult.data;
                        console.log(mteNewMsg);
                        list[k].newCount = mteNewMsg;
                       if (list[k].newCount != 0) {
                        list[k].isCount = true;
                       } 
                       else {
                         list[k].isCount = false;
                       }
                      var board = $('.board-call');
                      var template = Handlebars.compile($('#boardTemp').html()); 
                      board.html(template({'list': list}));
                      mteNewMsg = 0;
                    });
                  }); // each 문
            });
     }, 1000);
}

$(function() {
	  <!-- header load -->
userInfo();
boardList();
	  <!-- /header load -->
	  
	  <!-- expert service loader -->
/* 	  $(function() {
	    $(".board-call").load("board.html .board-dash");
	  }); */
    <!-- editor-explain click 이벤트 -->
    $(document.body).on("click", ".editor-explain", function() {
    	$(".editor-explain, .fa-plus").addClass("animated");
    	$(".editor-explain, .fa-plus").addClass("fadeOutUp");
    	setTimeout(function() {
    		init(); 
    		$('.editor-div').css('display', 'block');
    	}, 800);
    });
    <!-- /editor-explain click 이벤트 -->
    
    <!-- editor closs click 이벤트 -->
    $(document.body).on("click", ".editor-close", function() {
    	warnModalStart('plan-close');
      });
    <!-- /editor closs click 이벤트 -->
    <!-- across closs click 이벤트 -->
    $(document.body).on("click", ".across-close", function() {
        $(".this-across").addClass("animated");
        $(".this-across").addClass("fadeOut");
        setTimeout(function() {
        	  $(".this-across").remove();
		        $(".across").append("<div class='across dashboard animated fadeIn'><div class='across-explain'>Board에서 확인할 플랜을 선택하세요.</div></div>");
        }, 800);
		    $(".across").switchClass("frame-area-center", "frame-area-right", 2000, "easeInOutBack");
		    $(".board").switchClass("frame-area-left", "frame-area-center", 2000, "easeInOutBack");
      });
    <!-- /across closs click 이벤트 -->
    
    <!-- board에서 node 선택 시 across 이벤트 -->
    $(document.body).on("click", ".nodes", function() {
    	console.log($(this).attr("cono"));
      cono = $(this).attr("cono");
      $(".board").switchClass("frame-area-center", "frame-area-left", 2000, "easeInOutBack");
      $(".across").switchClass("frame-area-right", "frame-area-center", 2000, "easeInOutBack");
      $(".across").load("detail.html .across", function() {
    	  $.getJSON(serverRoot + '/plan/plmap.json', 
    			  {
    		    "cono" : cono
    			  }, function(ajaxResult) {
    				  console.log(ajaxResult);
    				  if(ajaxResult.status == 'fail') {
    					  alert(ajaxResult.status);
    					  return;
    				  } else if (ajaxResult.status == 'success') {
    					  console.log(ajaxResult.data.planMap);
    					  $('#viewSavedModel').val(ajaxResult.data.planMap); 
    					  setTimeout(function() {
    						  view_init();
    					  }, 2000);
    					  
    				  }
    	  });
    	  $.getJSON(serverRoot + '/QnaMentee/list.json', 
    		        {
    		      "cono": cono
    		        }, 
    		        function(ajaxResult) {
    		          var status = ajaxResult.status;
    		          if (status != "success") {
                        		        	  
    		            return;
    		          }
    		          
    		          var list = ajaxResult.data.list;
    		           console.log(list);
    		           
    		           $.each(list, function(k, v) {
    		               $.getJSON(serverRoot + '/message/nodeMessageCount.json', 
    		               {
    		                 "cono": v.contentsNo,
    		                 "sno" : v.memberNo,
    		                 "mswr": v.mentoNo
    		               }, function(ajaxResult) {
    		                   var status = ajaxResult.status;
    		                 if (ajaxResult.status != "success") {return};
    		                 var nodeNewCount = ajaxResult.data;
   		                  console.log(nodeNewCount);
    		                  list[k].newCount = nodeNewCount; 
    		                if (list[k].newCount != 0) {
    		                   list[k].isCount = true;
    		                } 
    		                else {
    		                  list[k].isCount = false;
    		                }


    		                var section = $('.detail-mentee-area .mentee-info-area');
    		                console.log(section);
    		                var template = Handlebars.compile($('#QnaMentee').html());
    		                section.html(template({"list": list}));
    		                 
    		                 
    		               });
    		             }); // each 문
    		             
    		        }); // 해당 설계도에 질의응답한 멘티 정보들 가져오기 json
    		        
      }); // detail 페이지 로드 이벤트
      
    }); // node 클릭시  이벤트
    <!-- /board에서 node 선택 시 across 이벤트 -->
	  
	  <!-- wheel & click 슬라이딩 이벤트 --> 
	  $(document.body).on("click", "#editor-btn", function() {
		  if($(".frame-area-center").hasClass("board")) {
        $(".editor").switchClass("frame-area-left", "frame-area-center", 2000, "easeInOutBack");
        $(".board").switchClass("frame-area-center", "frame-area-right", 2000, "easeInOutBack");
      } else if($(".frame-area-center").hasClass("across")) {
        $(".across").switchClass("frame-area-center", "frame-area-right", 2000, "easeInOutBack");
        $(".board").switchClass("frame-area-left", "frame-area-right", 2000, "easeInOutBack");
        $(".editor").switchClass("frame-area-left", "frame-area-center", 2000, "easeInOutBack");
      }
	  });
	  $(document.body).on("click", "#board-btn", function() {
		  if($(".frame-area-center").hasClass("editor")) {
        $(".editor").switchClass("frame-area-center", "frame-area-left", 2000, "easeInOutBack");
        $(".board").switchClass("frame-area-right", "frame-area-center", 2000, "easeInOutBack");
      } else if($(".frame-area-center").hasClass("across")) {
        $(".across").switchClass("frame-area-center", "frame-area-right", 2000, "easeInOutBack");
        $(".board").switchClass("frame-area-left", "frame-area-center", 2000, "easeInOutBack");
      }
	  });
	  
	  var sno;
	  var cono;

	  // 멘티 한명 클릭시 채팅창 보이기
	  $(document.body).on("click", ".mentee-info", function() {
		  userInfo();
		  console.log("들어왔닛??");
		  var mteName = $(this).children('.mentee-info-name').text();
		  var mteImg = $(this).children('img').attr('src');
			  console.log(mteName);
			  console.log(mteImg);
		  sno = Number($(this).attr('sno')); 
		  $('.chat-modal').load(clientRoot + '/expert/chat-2.html .window',function() {
		        $(".chat-modal").css('display','block');
			  $('.detail-mentee-area').css("display","none");
			  $('.bot h3').text(mteName);
			  $('.bot img').attr('src', mteImg);
			  
			  $.getJSON(serverRoot + '/message/list.json', 
			      {
			        "cono": cono, 
			        "sno" : sno,
			        "mno" : memberInfo.memberNo
			      }, function(ajaxResult) {
			        var status = ajaxResult.status; 
			        if (status != "success") return; 
			        
			        var list = ajaxResult.data.list;
			        $.each(list, function(k, v) {
			          var text   = list[k].message;
			          var writer = list[k].writerNo;
			          if (writer == memberInfo.memberNo) {
			              $('.chatwindow').append('<div class="right">' + text + '</div>');
			          } else {
			              $('.chatwindow').append('<div class="left bye">' + text + '</div>');
			          }
			          $(".chatwindow").scrollTop($(".chatwindow")[0].scrollHeight);
			        });
			      });

			$('#messenger').submit(function () {
			   return false;
			  });
			  $("#message").attr("autocomplete", "off");
			  
			    <!---- mentee message send service---->
			  $('#btn').click(function() {
			     var text = $('#message').val();
			     
			       $.getJSON(serverRoot + '/message/mento-send.json',
			           {
			             "msge": text, 
			             "cono": cono,
			             "sno" : sno, 
			             "eno" : expertNo
			           }, function(ajaxResult) {
			             var status = ajaxResult.status;
			             if (status != "success") return;
			       });
			       $('.chatwindow').append('<div class="right">' + text + '</div>');
			       $('#message').val('');
			       $(".mystuff-chatwindow").scrollTop($(".mystuff-chatwindow")[0].scrollHeight);

			  });
		  });
	  })
	  
	  
	  // 멘티와 채팅창 닫기 버튼 클릭 이벤트
	      $(document.body).on("click", ".chat-close", function() {
	    	  console.log($('.chat-close'));
     /*    $(".chat-modal").addClass("animated");
        $(".chat-modal").addClass("fadeOut"); */
        $(".chat-modal").css('display','none');
        $(".detail-mentee-area").css('display','block');
        $('.window').remove();
       /*  setTimeout(function() {
            $(".window").remove();
            $('.across .detail-mentee-area').load(clientRoot + '/expert/detail.html .detail-mentee-area');
        }, 800);
 */
      });
	  
	  
	  var wheelState;
	  var wheelType;
	  
	  $(".contents").on("mousewheel DOMMouseScroll", function(event) {
	    wheelState = true; 
	    wheelType = event.originalEvent.wheelDelta;
	  });
	    
	  function hasScrolled() {
		  if($(".frame-area-center").hasClass("board")) {
			  if (wheelType < 0) {
				  $(".board").switchClass("frame-area-center", "frame-area-left", 2000, "easeInOutBack");
				  $(".across").switchClass("frame-area-right", "frame-area-center", 2000, "easeInOutBack");
			  } else {
					  $(".board").switchClass("frame-area-center", "frame-area-right", 2000, "easeInOutBack");
					  $(".editor").switchClass("frame-area-left", "frame-area-center", 2000, "easeInOutBack");
			  }
		  } else if($(".frame-area-center").hasClass("editor")) {
	       if (wheelType < 0) {
		       $(".editor").switchClass("frame-area-center", "frame-area-left", 2000, "easeInOutBack");
		       $(".board").switchClass("frame-area-right", "frame-area-center", 2000, "easeInOutBack");
	       } else {
	           $(".editor").switchClass("frame-area-center", "frame-area-left", 2000, "easeInOutBack");
	           $(".board").switchClass("frame-area-right", "frame-area-left", 2000, "easeInOutBack");
	           setTimeout(function() {
	             $(".across").switchClass("frame-area-right", "frame-area-center", 2000, "easeInOutBack");
	           }, 350);
	       }
		  } else if($(".frame-area-center").hasClass("across")) {
         if (wheelType < 0) {
           $(".across").switchClass("frame-area-center", "frame-area-right", 2000, "easeInOutBack");
           $(".board").switchClass("frame-area-left", "frame-area-right", 2000, "easeInOutBack");
           setTimeout(function() {
	           $(".editor").switchClass("frame-area-left", "frame-area-center", 2000, "easeInOutBack");
           }, 350);
	       } else {
	           $(".across").switchClass("frame-area-center", "frame-area-right", 2000, "easeInOutBack");
	           $(".board").switchClass("frame-area-left", "frame-area-center", 2000, "easeInOutBack");
	       }
		  }
	  };
	    
	  setInterval(function() {
	    if (wheelState) {
	      hasScrolled(); 
	      wheelState = false; 
	    }
	  }, 250);
	  <!-- /wheel & click 슬라이딩 이벤트 -->
});


</script>
<script id="boardTemp" type="text/x-handlebars-template">
{{#each list}}
    <div id="node" cono="{{contentsNo}}" class="nodes animated fadeIn">
      <div class="node-img">
       <img class="node-img" alt="" src="http://localhost:8080/bitcamp-project-s/upload/{{planImage}}">
        {{#if isCount}}
          <label class="plan-new-count" for="msgCount">{{newCount}}</label>
        {{else}}
          <label class="not-count" for="msgCount">{{newCount}}</label>
        {{/if}}
       <div class="animated fadeIn" id="node-modify">수정</div>
       <div class="animated fadeIn" id="node-delete">삭제</div>
      </div>
      <div id="title">{{topicName}}<br/>{{planName}}</div>
    </div>
{{/each}}
</script>
<script id="QnaMentee" type="text/x-handlebars-template">
{{#each list}}
   <div class="mentee-info" sno={{memberNo}}>
          <img alt="" src="../mystuff/img/{{photoPath}}">
      {{#if isCount}}
            <label class="plan-new-count" for="msgCount">{{newCount}}</label>
         {{else}}
            <label class="not-count" for="msgCount">{{newCount}}</label>
       {{/if}}
          <div class="mentee-info-name">{{name}}</div>
        </div>
{{/each}}
</script>
</body>
</html>

